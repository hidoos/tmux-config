# Tmux 101 使用指南

> 基于本项目的 tmux 配置的完整入门教程

## 📚 目录

- [第一部分：基础概念](#第一部分基础概念)
- [第二部分：基础操作](#第二部分基础操作)
- [第三部分：会话管理](#第三部分会话管理)
- [第四部分：窗口管理](#第四部分窗口管理)
- [第五部分：面板操作](#第五部分面板操作)
- [第六部分：复制和粘贴](#第六部分复制和粘贴)
- [第七部分：高级功能](#第七部分高级功能)
- [第八部分：实用工作流示例](#第八部分实用工作流示例)
- [第九部分：常用技巧](#第九部分常用技巧)
- [第十部分：学习路径建议](#第十部分学习路径建议)
- [快速参考卡片](#快速参考卡片)
- [故障排除](#故障排除)

---

## 第一部分：基础概念

### 什么是 Tmux？

Tmux（Terminal Multiplexer）是一个终端复用器，它让你能够：

- ✅ 在一个终端窗口中管理多个会话
- ✅ 即使断开 SSH 连接，程序仍然继续运行
- ✅ 高效地管理多个窗口和面板
- ✅ 提高命令行工作效率

### 核心概念

Tmux 有三个核心概念，理解它们很重要：

1. **会话（Session）**：工作环境的容器，可以包含多个窗口
2. **窗口（Window）**：会话中的标签页，类似浏览器标签
3. **面板（Pane）**：窗口中的分割区域，可以在一个窗口中同时显示多个终端

```
┌─────────────────────────────────────┐
│  Session (会话)                     │
│  ┌───────────────────────────────┐ │
│  │ Window 1 (窗口)               │ │
│  │ ┌──────────┬────────────────┐ │ │
│  │ │  Pane 1  │    Pane 2      │ │ │
│  │ │          │                │ │ │
│  │ └──────────┴────────────────┘ │ │
│  └───────────────────────────────┘ │
│  ┌───────────────────────────────┐ │
│  │ Window 2 (窗口)               │ │
│  └───────────────────────────────┘ │
└─────────────────────────────────────┘
```

### ⚠️ 重要提示：你的配置

在使用本教程之前，请注意你的 tmux 配置有以下特点：

- **前缀键**：`Ctrl+s`（不是默认的 `Ctrl+b`）
- **鼠标支持**：已开启，可以用鼠标操作
- **Vim 风格**：复制模式使用 Vim 键位
- **真彩色**：支持 True Color 显示
- **自动重编号**：窗口会自动重新编号

---

## 第二部分：基础操作

### 1. 启动和退出

#### 启动 tmux

```bash
# 启动 tmux（使用默认会话名）
tmux

# 启动并命名会话
tmux new -s mywork

# 启动并指定工作目录
tmux new -s dev -c ~/projects/myapp
```

#### 退出 tmux

有两种方式：

1. **退出并关闭会话**（会话中的所有窗口都会关闭）：
   ```bash
   exit
   # 或者
   Ctrl+d
   ```

2. **分离会话**（会话在后台继续运行）：
   ```
   Ctrl+s 然后按 d
   ```
   这样会话会继续运行，稍后可以用 `tmux attach -t 会话名` 重新连接。

#### 重新连接会话

```bash
# 列出所有会话
tmux ls

# 连接到指定会话
tmux attach -t 会话名

# 或者简写
tmux a -t 会话名
```

### 2. 前缀键的使用

**所有 tmux 命令都需要先按前缀键 `Ctrl+s`，然后按其他键。**

例如：
- `Ctrl+s` + `r` = 重新加载配置文件
- `Ctrl+s` + `C-c` = 新建会话

**提示**：按完 `Ctrl+s` 后，底部状态栏会显示提示，告诉你现在可以输入命令了。

---

## 第三部分：会话管理

### 创建和管理会话

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 新建会话 | `Ctrl+s` + `C-c` | 在当前会话中创建新会话 |
| 新建会话（脚本） | `Alt+Shift+s` | 使用脚本创建会话，更智能 |
| 重命名会话 | `Ctrl+s` + `.` | 重命名当前会话 |
| 查看所有会话 | `Ctrl+s` + `W` | 打开选择树浏览会话和窗口 |

### 切换会话

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+1` ~ `Ctrl+9` | 按索引切换到会话 1-9 |
| `F1` ~ `F5` | 备选方式，切换到会话 1-5 |
| `Ctrl+s` + `l` | 向左移动会话（交换位置） |
| `Ctrl+s` + `y` | 向右移动会话（交换位置） |

### 💡 练习 1：会话管理

1. 创建 3 个会话：
   ```bash
   tmux new -s work
   tmux new -s play
   tmux new -s test
   ```

2. 在任意会话中，使用 `Ctrl+1`、`Ctrl+2`、`Ctrl+3` 在它们之间切换

3. 尝试重命名会话：`Ctrl+s` + `.`，输入新名称

4. 查看所有会话：`Ctrl+s` + `W`，使用方向键浏览

---

## 第四部分：窗口管理

### 创建和切换窗口

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 新建窗口 | `Alt+o` | 保持当前路径创建新窗口 |
| 关闭 pane | `Alt+Q` | 关闭当前面板 |
| 拆分 pane 为窗口 | `Alt+O` | 将当前 pane 拆分为独立窗口 |
| 重命名窗口 | `Ctrl+s` + `,` | 重命名当前窗口 |
| 切换 scratchpad | `Alt+s` | 切换临时工作区（隐藏/显示） |

### 窗口导航

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+s` + `C-p` | 上一个窗口 |
| `Ctrl+s` + `C-n` | 下一个窗口 |
| `Alt+1` ~ `Alt+9` | 直接切换到窗口 1-9（最快） |
| `Alt+<` | 与左边窗口交换位置 |
| `Alt+>` | 与右边窗口交换位置 |

**提示**：窗口会自动重编号，关闭窗口 2 后，窗口 3 会自动变成窗口 2。

### 💡 练习 2：窗口管理

1. 创建 3 个窗口：
   - 窗口 1：运行 `htop`（`Alt+o` 然后输入 `htop`）
   - 窗口 2：运行 `vim`（`Alt+o` 然后输入 `vim`）
   - 窗口 3：运行 `ls -la`（`Alt+o` 然后输入 `ls -la`）

2. 使用 `Alt+1`、`Alt+2`、`Alt+3` 在窗口间快速切换

3. 尝试重命名窗口：`Ctrl+s` + `,`，输入 "编辑器"、"监控" 等名称

---

## 第五部分：面板操作

### 分割窗口

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+s` + `u` | 向上分割（水平分割，新面板在上） |
| `Ctrl+s` + `e` | 向下分割（水平分割，新面板在下） |
| `Ctrl+s` + `n` | 向左分割（垂直分割，新面板在左） |
| `Ctrl+s` + `i` | 向右分割（垂直分割，新面板在右） |

**记忆技巧**：
- `u` = up（上）
- `e` = down（下，e 在键盘上在 d 旁边）
- `n` = left（左，n 在键盘左边）
- `i` = right（右，i 在键盘右边）

### 面板导航

| 快捷键 | 说明 |
|--------|------|
| `Alt+h` | 选择左边 pane |
| `Alt+j` | 选择下边 pane |
| `Alt+k` | 选择上边 pane |
| `Alt+l` | 选择右边 pane |
| `Alt+f` | 切换 pane 全屏缩放（放大/缩小） |

**提示**：这些键位与 Vim 的 `h/j/k/l` 导航一致，非常直观。

### 调整面板大小

| 快捷键 | 说明 |
|--------|------|
| `Alt+H` | 向左调整 3 格 |
| `Alt+J` | 向下调整 3 格 |
| `Alt+K` | 向上调整 3 格 |
| `Alt+L` | 向右调整 3 格 |

**提示**：大写字母用于调整大小，小写字母用于导航。

### 移动和交换面板

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+s` + `>` | 与下一个 pane 交换位置 |
| `Ctrl+s` + `<` | 与上一个 pane 交换位置 |
| `Ctrl+s` + `\|` | 交换 pane（交互式选择） |
| `Ctrl+s` + `Space` | 切换 pane 布局方向（水平/垂直） |

### 移动 Pane 到窗口

有时候你想把当前面板移动到另一个窗口：

| 快捷键 | 目标窗口 | 实际按键 |
|--------|----------|----------|
| `Alt+!` | 窗口 1 | `Alt + Shift + 1` |
| `Alt+@` | 窗口 2 | `Alt + Shift + 2` |
| `Alt+#` | 窗口 3 | `Alt + Shift + 3` |
| `Alt+$` | 窗口 4 | `Alt + Shift + 4` |
| `Alt+%` | 窗口 5 | `Alt + Shift + 5` |
| `Alt+^` | 窗口 6 | `Alt + Shift + 6` |
| `Alt+&` | 窗口 7 | `Alt + Shift + 7` |
| `Alt+*` | 窗口 8 | `Alt + Shift + 8` |
| `Alt+(` | 窗口 9 | `Alt + Shift + 9` |

> **注意**：`Alt+1` ~ `Alt+9` 用于窗口切换，不能用于移动 pane

### 💡 练习 3：面板操作

1. 创建一个窗口，分割成 4 个面板（2x2 布局）：
   ```
   Ctrl+s + e  # 向下分割
   Ctrl+s + i  # 向右分割（在下方面板）
   Ctrl+s + i  # 向右分割（在上方面板）
   ```

2. 在每个面板中运行不同的命令：
   - 面板 1：`htop`
   - 面板 2：`watch -n 1 date`
   - 面板 3：`tail -f /var/log/syslog`（如果有权限）
   - 面板 4：`vim`

3. 使用 `Alt+h/j/k/l` 在面板间移动

4. 尝试使用 `Alt+f` 放大某个面板，再按一次恢复

5. 使用 `Alt+H/J/K/L` 调整面板大小

---

## 第六部分：复制和粘贴

### 进入复制模式

按 `Alt+v` 进入复制模式（Vim 风格）

你会看到屏幕右上角显示 "COPY" 模式。

### 在复制模式中移动

| 快捷键 | 说明 |
|--------|------|
| `h/j/k/l` | 左/下/上/右移动 |
| `w/b/e` | 下一个/上一个单词/单词末尾 |
| `0/$` | 行首/行尾 |
| `H/L` | 行首/行尾（自定义） |
| `gg/G` | 文件开头/末尾 |
| `Ctrl+u/d` | 向上/下翻半页 |
| `Ctrl+b/f` | 向上/下翻整页 |

### 搜索

| 快捷键 | 说明 |
|--------|------|
| `/` | 向下搜索（输入搜索词后按 Enter） |
| `?` | 向上搜索 |
| `n` | 下一个匹配 |
| `N` | 上一个匹配 |

### 选择和复制

| 快捷键 | 说明 |
|--------|------|
| `v` | 开始选择（字符选择） |
| `V` | 行选择 |
| `Ctrl+v` | 矩形选择切换（列选择） |
| `y` | 复制选中内容并退出复制模式 |
| `Y` | 复制到行尾 |

### 粘贴

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+Shift+v` | 从系统剪贴板粘贴 |
| `Alt+V` | 从系统剪贴板粘贴（备选） |
| `Ctrl+s` + `b` | 列出所有缓冲区 |
| `Ctrl+s` + `p` | 粘贴 tmux 缓冲区 |

### 💡 练习 4：复制和粘贴

1. 在终端中运行 `ls -la`，显示文件列表

2. 进入复制模式：`Alt+v`

3. 使用 Vim 键位导航到某个文件名：
   - 按 `j` 向下移动
   - 按 `w` 跳到下一个单词

4. 选择文本：
   - 按 `v` 开始选择
   - 使用 `h/j/k/l` 或 `w/b` 扩展选择
   - 按 `y` 复制

5. 切换到另一个面板：`Alt+h/j/k/l`

6. 粘贴：`Ctrl+s` + `p`

---

## 第七部分：高级功能

### 同步输入

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+s` + `C-g` | 切换同步输入（多 pane 同时输入） |

**用途**：当开启同步输入后，你在一个面板中输入的命令会在所有面板中同时执行。这在管理多台服务器时非常有用。

**提示**：开启同步后，面板边框会变成红色，提醒你当前处于同步模式。

### 布局构建

这些快捷键可以智能地扩展布局：

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+s` + `I` | 向右扩展布局 |
| `Ctrl+s` + `N` | 向左扩展布局 |
| `Ctrl+s` + `U` | 向上扩展布局 |
| `Ctrl+s` + `E` | 向下扩展布局 |

**用途**：当你有很多面板时，可以快速调整布局，让某个方向的面板变大。

### 选择树操作

选择树是一个强大的可视化工具，可以浏览和管理所有会话、窗口和面板：

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+s` + `W` | 打开选择树（可缩放） |
| `Ctrl+s` + `S` | 选择树 - 垂直移动 pane |
| `Ctrl+s` + `V` | 选择树 - 水平移动 pane |

**使用技巧**：
- 在选择树中，使用方向键导航
- 按 `Enter` 选择
- 按 `Esc` 或 `q` 退出
- 可以搜索会话和窗口名称

### Agent Tracker 集成

Agent Tracker 是一个任务追踪工具，与 tmux 深度集成：

| 快捷键 | 说明 |
|--------|------|
| `Alt+t` | 切换 agent-tracker（显示/隐藏） |
| `Alt+m` | 聚焦最新通知的 pane |
| `Alt+M` | 聚焦最后原点 pane |

**用途**：帮助你追踪在不同面板中运行的任务，快速跳转到有通知的面板。

---

## 第八部分：实用工作流示例

### 工作流 1：开发环境

典型的开发环境设置：

```bash
# 1. 创建开发会话
tmux new -s dev

# 2. 创建多个窗口
# 窗口 1: 代码编辑器
Alt+o  # 新建窗口
vim src/main.py

# 窗口 2: 终端（运行命令）
Alt+o  # 新建窗口
# 可以运行测试、构建等命令

# 窗口 3: 日志监控
Alt+o  # 新建窗口
tail -f logs/app.log

# 3. 在窗口 1 中分割面板
Ctrl+s + i  # 右边分割
# 在右侧面板运行测试
pytest

# 4. 快速切换
Alt+1  # 切换到编辑器
Alt+2  # 切换到终端
Alt+3  # 切换到日志
```

### 工作流 2：多项目管理

为每个项目创建独立的会话：

```bash
# 为每个项目创建会话
tmux new -s project1 -c ~/projects/project1
tmux new -s project2 -c ~/projects/project2
tmux new -s project3 -c ~/projects/project3

# 使用 Ctrl+1/2/3 快速切换
Ctrl+1  # 切换到 project1
Ctrl+2  # 切换到 project2
Ctrl+3  # 切换到 project3
```

### 工作流 3：服务器管理

管理多台服务器：

```bash
# 创建服务器管理会话
tmux new -s servers

# 在窗口中分割多个面板
# 每个面板 SSH 到不同服务器
Ctrl+s + e  # 下分割
Ctrl+s + i  # 右分割

# 面板 1: SSH server1
ssh user@server1

# 面板 2: SSH server2
ssh user@server2

# 面板 3: SSH server3
ssh user@server3

# 使用同步输入同时执行命令
Ctrl+s + C-g  # 开启同步
# 现在输入的命令会在所有服务器上同时执行
uptime
```

### 工作流 4：代码审查

```bash
# 创建代码审查会话
tmux new -s review

# 窗口 1: 代码
Alt+o
vim diff.patch

# 窗口 2: 分割查看
Ctrl+s + e  # 下分割
# 上方：查看原始文件
# 下方：查看修改后的文件

# 快速在代码和终端间切换
Alt+1  # 代码窗口
Alt+2  # 终端窗口
```

---

## 第九部分：常用技巧

### 1. 重新加载配置

修改 `.tmux.conf` 后，不需要重启 tmux：

```
Ctrl+s + r
```

状态栏会显示 "~/.tmux.conf sourced" 确认已重新加载。

### 2. 查看缓冲区

tmux 会保存你复制的内容到缓冲区：

```
Ctrl+s + b  # 列出所有缓冲区
Ctrl+s + p  # 粘贴缓冲区
```

### 3. 鼠标操作

你的配置已开启鼠标支持，可以：

- ✅ 点击窗口标签切换窗口
- ✅ 点击面板切换焦点
- ✅ 拖拽面板边框调整大小
- ✅ 点击选择文本（在某些终端中）

### 4. 窗口自动重编号

配置已开启 `renumber-windows on`，关闭窗口后会自动重新编号。

例如：
- 有窗口 1, 2, 3
- 关闭窗口 2
- 窗口 3 自动变成窗口 2

### 5. 保持当前路径

使用 `Alt+o` 创建新窗口时，会自动保持当前工作目录，非常方便。

### 6. 快速查找

在选择树（`Ctrl+s + W`）中，可以输入搜索词快速找到会话或窗口。

### 7. 临时全屏

使用 `Alt+f` 可以临时全屏某个面板，查看详细信息，再按一次恢复。

---

## 第十部分：学习路径建议

### 第 1 周：基础掌握

**目标**：能够基本使用 tmux 进行日常工作

- [ ] 掌握前缀键 `Ctrl+s` 的使用
- [ ] 学会创建和切换窗口（`Alt+1` ~ `Alt+9`）
- [ ] 学会分割面板（`Ctrl+s` + `u/e/n/i`）
- [ ] 学会面板导航（`Alt+h/j/k/l`）
- [ ] 学会创建和切换会话（`Ctrl+1` ~ `Ctrl+9`）

**每日练习**：
- 早上：创建一个工作会话，设置 3 个窗口
- 下午：练习面板分割和导航
- 晚上：尝试重命名会话和窗口

### 第 2 周：进阶功能

**目标**：熟练使用高级功能

- [ ] 掌握复制模式（`Alt+v`）
- [ ] 学会使用选择树（`Ctrl+s` + `W`）
- [ ] 学会移动面板到窗口
- [ ] 学会同步输入功能（`Ctrl+s` + `C-g`）
- [ ] 学会使用布局构建

**每日练习**：
- 练习在复制模式中搜索和选择文本
- 尝试使用选择树管理多个会话
- 练习同步输入管理多台服务器

### 第 3 周：高级技巧

**目标**：建立自己的工作流

- [ ] 掌握 Agent Tracker 集成
- [ ] 建立自己的开发工作流
- [ ] 优化窗口和面板布局
- [ ] 学会使用所有高级快捷键

**每日练习**：
- 为不同项目建立不同的会话结构
- 尝试使用 Agent Tracker 追踪任务
- 优化常用操作的快捷键组合

### 第 4 周：精通

**目标**：成为 tmux 专家

- [ ] 能够快速设置任何工作环境
- [ ] 能够教授他人使用 tmux
- [ ] 能够根据需求自定义配置
- [ ] 能够解决常见问题

---

## 快速参考卡片

### 最常用的快捷键

```
前缀键: Ctrl+s

【会话管理】
Ctrl+s + C-c    新建会话
Ctrl+1 ~ 9      切换会话
Ctrl+s + .      重命名会话
Ctrl+s + W      选择树

【窗口管理】
Alt+o           新建窗口
Alt+1 ~ 9       切换窗口
Ctrl+s + ,      重命名窗口
Ctrl+s + C-p/n  上一个/下一个窗口

【面板操作】
Ctrl+s + u/e/n/i  分割面板（上/下/左/右）
Alt+h/j/k/l       面板导航
Alt+f              全屏切换
Alt+H/J/K/L        调整大小

【复制粘贴】
Alt+v           进入复制模式
Ctrl+Shift+v    从系统剪贴板粘贴
Ctrl+s + p      粘贴缓冲区

【其他】
Ctrl+s + r      重新加载配置
Ctrl+s + C-g    同步输入
Alt+t           切换 agent-tracker
```

### 快捷键记忆技巧

1. **分割面板**：`u/e/n/i` = 上/下/左/右（按键盘位置记忆）
2. **面板导航**：`Alt+h/j/k/l` = Vim 导航键
3. **窗口切换**：`Alt+数字` = 直接跳转（最快）
4. **会话切换**：`Ctrl+数字` = 会话切换
5. **复制模式**：`Alt+v` = Vim 的 visual 模式

---

## 故障排除

### 问题 1：快捷键不工作

**可能原因**：
- 没有先按前缀键 `Ctrl+s`
- 配置没有重新加载

**解决方法**：
1. 确保先按 `Ctrl+s`，再按其他键
2. 重新加载配置：`Ctrl+s + r`
3. 检查终端是否支持这些快捷键

### 问题 2：无法粘贴

**可能原因**：
- 使用了错误的粘贴快捷键
- 剪贴板集成问题

**解决方法**：
1. 使用 `Ctrl+Shift+v` 或 `Alt+V` 从系统剪贴板粘贴
2. 使用 `Ctrl+s + p` 粘贴 tmux 缓冲区
3. 检查终端和系统的剪贴板设置

### 问题 3：面板太小

**解决方法**：
1. 使用 `Alt+H/J/K/L` 调整面板大小
2. 使用 `Alt+f` 全屏某个面板
3. 关闭不需要的面板：`Alt+Q`

### 问题 4：窗口编号混乱

**解决方法**：
- 配置已开启自动重编号，关闭窗口后会自动调整
- 如果还是混乱，可以手动关闭并重新创建窗口

### 问题 5：鼠标不工作

**解决方法**：
1. 检查配置中 `set -g mouse on` 是否启用
2. 重新加载配置：`Ctrl+s + r`
3. 某些终端可能需要特殊设置

### 问题 6：颜色显示不正常

**解决方法**：
1. 检查终端是否支持 True Color
2. 设置环境变量：`export TERM=tmux-256color`
3. 重新加载配置：`Ctrl+s + r`

### 问题 7：无法连接到会话

**解决方法**：
```bash
# 列出所有会话
tmux ls

# 连接到指定会话
tmux attach -t 会话名

# 如果会话不存在，创建新会话
tmux new -s 会话名
```

### 问题 8：快捷键冲突

**解决方法**：
- 某些快捷键可能与终端或应用程序冲突
- 可以修改 `.tmux.conf` 中的快捷键绑定
- 或者使用 `Ctrl+s` + `W` 选择树作为备选方案

---

## 额外资源

### 官方文档

- [Tmux 官方文档](https://tmux.github.io/)
- [Tmux 手册页](https://man.openbsd.org/tmux)

### 学习资源

- [Tmux 速查表](https://tmuxcheatsheet.com/)
- [Awesome Tmux](https://github.com/rothgar/awesome-tmux)

### 配置文件

- 主配置文件：`~/.tmux.conf`
- 脚本目录：`~/.config/tmux/scripts/`
- 状态栏脚本：`~/.config/tmux/tmux-status/`

---

## 总结

恭喜你完成了 Tmux 101 教程！现在你应该能够：

✅ 创建和管理会话、窗口、面板  
✅ 使用快捷键高效导航  
✅ 复制和粘贴文本  
✅ 使用高级功能提高效率  
✅ 建立自己的工作流  

**下一步**：
- 开始在日常工作中使用 tmux
- 根据需求调整配置
- 探索更多高级功能
- 分享你的使用技巧

记住：**熟能生巧**！每天使用 tmux，很快它就会成为你不可或缺的工具。

---

*最后更新：基于本项目 tmux 配置*  
*前缀键：`Ctrl+s`*
